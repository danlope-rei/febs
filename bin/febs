#!/usr/bin/env node
const febs = require('../src/index.js');
const program = require('commander');
// const logger = require('../src/lib/logger');

program
  .usage('[task] [options]')
  .description('Builds and bundles front-end assets with minimal configuration\n')
  .version(require('../package.json').version)
  .option('-v, --verbose', 'Increase logging verbosity of build system')
  .option('--debug', 'Higher level of verbosity, including debug output');

program
  .command('prod')
  .description('(Default) Builds front-end assets optimized for production\n')
  .action((command) => {
    febs({
      env: 'prod',
      command,
    }).compile();
  });


program
  .command('dev')
  .description('Build/Serves front-end assets optimized for local development\n')
  .action((command) => {
    febs({
      env: 'dev',
      command,
    }).compile();
  });

program
  .command('test')
  .description('Runs unit tests.\n')
  .option('-c, --cover', 'Run test coverage')
  .option('-w, --watch', 'Watch mode')
  .action((command) => {
    febs({
      env: 'dev', // <-- client unit tests, env is a don't care.
      command,
    }).test();
  });

program
  .on('--help', () => {
    process.stdout.write(`  Examples:
        $ febs dev --no-watch
        $ febs prod --verbose
        $ febs test
        $ febs test --coverage
    `);
  });

program.parse(process.argv);
